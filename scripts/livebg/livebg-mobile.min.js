(function(n){typeof define=="function"?define.amd?define(["jquery"],n):define.cmd&&define(function(t){return n(t("jquery"))}):typeof exports=="object"?module.exports=n:n(jQuery)})(function(n){function t(f,e){var w=this.$wrap=n(f),v=this.options=n.extend({},t.defaults,e),g=this,b,k,p;if(o=v.throwError,v.focusVal||(b={left:0,right:1},k={top:0,bottom:1},v.focus.match(" ")||(v.focus+=" center"),p=v.focus.split(" "),v.focusVal={},v.focusVal.h=b[p[0]]!==undefined?b[p[0]]:b[p[1]]!==undefined?b[p[1]]:.5,v.focusVal.v=k[p[0]]!==undefined?k[p[0]]:k[p[1]]!==undefined?k[p[1]]:.5),w.length&&w.attr("livebg-init")!="true"){w.attr("livebg-init","true");var nt,d,y=this.minSize={},tt={},it=v.src=v.src?v.src:a(w),rt=c(w,it);nt=this.$img=rt.find("."+r.img);d=this.$imgClone=rt.find("."+r.imgClone);l(it,function(r){tt.width=r.width;tt.height=r.height;v.minWidth!=""&&v.minHeight!=""?v.mode?(y.height=v.minHeight,y.width=u(d,y.height)):(y.width=v.minWidth,y.height=i(d,y.width)):v.minWidth!=""?(y.width=v.minWidth,y.height=i(d,y.width)):v.minHeight!=""&&(y.height=v.minHeight,y.width=u(d,y.height));h(g,!1);v.follow&&t.prototype.turnOnFollow.call(g);v.showFunc.call(w,nt,v);v.resizeByWindow&&n(window).resize(function(){clearTimeout(s);s=setTimeout(function(){h(g,!1)})})})}else v.showFunc.call(n(this),n(this).find("."+r.img),v)}function c(t,i){var u=n(t);return u.css("position")=="static"&&u.css("position","relative"),u.find("."+r.wrap).length&&u.find("."+r.wrap).remove(),n('<div class="'+r.wrap+'" style="'+e.wrap+'"><img class="'+r.imgClone+'" style="'+e.imgClone+'" src="'+i+'" /><img class="'+r.img+'" style="'+e.img+'" src="'+i+'" /><\/div>').prependTo(u)}function l(n,t){var i=new Image;i.onload=function(){i.onload=null;typeof t=="function"&&t(i)};i.onerror=function(){o(1,"图片加载出错")};i.src=n}function a(t){var r=n(t).css("backgroundImage"),i;return(n(t).css("backgroundImage","none"),i=r.match(/\"(.*?)\"/)||r.match(/\((.*?)\)/),!i)?(o(0,"获取图片路径出错，此元素没有背景图片"),!1):i[1]}function h(n,r){var e=n.$img,o=n.options.focusVal,f=t.prototype.getZoomInfo.call(n);n.options.mode==0?i(e,f.width):u(e,f.height);r?e.stop(!0,!1).animate({marginTop:f.top,marginLeft:f.left}):e.css({"-webkit-transform":"translate3d("+f.left+"px,"+f.top+"px,0px)"})}function f(i){function f(n){var t,i,r;n=n.originalEvent;null!==n.alpha&&(t=1*n.alpha.toFixed(0),i=n.beta.toFixed(0),r=n.gamma.toFixed(0),e(t,i,r))}function e(n,i,f){var e;if(!r){r=!0;e=30;i>e&&(i=e)||i<-e&&(i=-e);f>e&&(f=e)||f<-e&&(f=-e);var o=t.prototype.getZoomInfo.call(u),s=(o.contentWidth-o.width)*(e-i)/(2*e),h=(o.contentHeight-o.height)*(e-f)/(2*e);u.$img.css({"-webkit-transform":"translate3d("+s+"px,"+h+"px,0px)"});r=!1}}var r=!1,u=this;window.DeviceMotionEvent||u.throwError(1,"浏览器不支持DeviceMotionEvent","noDME");(i===undefined||i)&&n(window).bind("deviceorientation ",f)}function i(n,t){return n.css("height","auto").width(t).height()}function u(n,t){return n.css("width","auto").height(t).width()}function v(n){for(var i=n.offsetLeft,t=n.offsetParent;t!==null;)i+=t.offsetLeft,t=t.offsetParent;return i}function y(n){for(var i=n.offsetTop,t=n.offsetParent;t!==null;)i+=t.offsetTop,t=t.offsetParent;return i}var n=n,e={wrap:"position:absolute;width:100%;height:100%;left:0;top:0;overflow:hidden",img:"position:absolute;display:none;transition:-webkit-transform .4s ease-out",imgClone:"position:absolute;visibility:hidden;"},r={wrap:"livebg",img:"livebg-img",imgClone:"livebg-img-clone"},o,s=null;return t.prototype.getZoomInfo=function(n){var l=this.$wrap,e=this.options,f,o,v;if(!e){alert("无法获取缩放信息，元素缺少配置信息");return}n?(f=n.wrapSize?n.wrapSize:{width:l.width(),height:l.height()},o=n.miniSize?n.miniSize:this.minSize):(f={width:l.width(),height:l.height()},o=this.minSize);var s=this.$imgClone,r,t,y=e.focusVal,a=0;this.paddingH===undefined&&(v=e.padding.toString().match("%")?parseInt(f.width*parseInt(e.padding,10)*.01,10):parseInt(e.padding,10),e.mode?(this.paddingV=v,this.paddingH=0):(this.paddingH=v,this.paddingV=0));var a=this.paddingH,c=this.paddingV,h={};return n&&n.imgSize?e.mode==0&&n.imgSize.width?(t=parseInt(n.imgSize.width,10),r=i($img,t)):n.imgSize.height?(r=parseInt(n.imgSize.height,10),t=u($img,r)):(t=parseInt(n.imgSize.width,10),r=i($img,t)):e.mode==0?f.width>=o.width+a*2?(t=f.width+a*2,r=i(s,t),f.height>r&&e.isFull&&(r=f.height,t=u(s,r))):f.height<=o.height?(r=o.height,t=u(s,r)):e.isFull?(r=f.height,t=u(s,r)):(t=o.width+a*2,r=i(s,t)):e.mode==1&&(f.height>=o.height+c*2?(r=f.height+c*2,t=u(s,r),f.width>t&&e.isFull&&(t=f.width+c*2,r=i(s,t))):f.width<=o.width?(t=o.width+c*2,r=i(s,t)):e.isFull?(t=f.width,r=i(s,t)):(r=o.height+c*2,t=u(s,r))),h.width=t,h.height=r,h.top=(f.height-r)*y.v-c,h.left=(f.width-t)*y.h-a,h.contentWidth=f.width,h.contentHeight=f.height,h},t.prototype.turnOnFollow=function(n){this.options.follow=n!==undefined?n:this.options.follow?this.options.follow:!0;typeof this.options.follow=="boolean"?f.call(this,!0):f.call(this,!0)},t.prototype.turnOffFollow=function(){typeof this.options.follow=="boolean"?f.call(this,!1):f.call(this,!1)},t.prototype.getMousePosition=function(n){var t=v(this.$wrap[0]),i=y(this.$wrap[0]),r=n.pageX,u=n.pageY;return{x:r-t,y:u-i}},t.prototype.reset=function(i){this.$wrap.attr("livebg-init","false");this.$wrap.find("."+r.wrap).remove();t.call(this,this.$wrap,n.extend({},this.options,i))},t.defaults={mode:0,minWidth:600,minHeight:"",isFull:!0,focus:"center center",padding:0,src:"",follow:!1,resizeByWindow:!0,showFunc:function(n){n.fadeIn()},throwError:function(n,t){n==0?console.error(t):n==1&&alert(t)}},window.Livebg=t});
//# sourceMappingURL=livebg-mobile.min.js.map