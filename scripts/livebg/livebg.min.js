(function(n){typeof define=="function"?define.amd?define(["jquery"],n):define.cmd&&define(function(t){return n(t("jquery"))}):typeof exports=="object"?module.exports=n:n(jQuery)})(function(n){function t(f,e){var w=this.$wrap=n(f),s=this.options=n.extend({},t.defaults,e),b=this,k,d,l;if(o=s.throwError,this.autoId=t.autoId++,s.focusVal||(k={left:0,right:1},d={top:0,bottom:1},s.focus.match(" ")||(s.focus+=" center"),l=s.focus.split(" "),s.focusVal={},s.focusVal.h=k[l[0]]!==undefined?k[l[0]]:k[l[1]]!==undefined?k[l[1]]:.5,s.focusVal.v=d[l[0]]!==undefined?d[l[0]]:d[l[1]]!==undefined?d[l[1]]:.5),w.length&&w.attr("livebg-init")!="true"){w.attr("livebg-init","true");var tt,g,c=this.minSize={},it={},rt=s.src=s.src?s.src:p(w),nt=v(w,rt);s.isFixed||nt.css("position","absolute");tt=this.$img=nt.find("."+r.img);g=this.$imgClone=nt.find("."+r.imgClone);y(rt,function(r){it.width=r.width;it.height=r.height;s.minWidth!=""&&s.minHeight!=""?s.mode?(c.height=s.minHeight,c.width=u(g,c.height)):(c.width=s.minWidth,c.height=i(g,c.width)):s.minWidth!=""?(c.width=s.minWidth,c.height=i(g,c.width)):s.minHeight!=""&&(c.height=s.minHeight,c.width=u(g,c.height));h(b,!0);s.follow&&t.prototype.turnOnFollow.call(b);s.showFunc.call(w,tt,s);s.resizeByWindow&&(screen.width==n(window).width()&&(b.maxWidth=!0),n(window).resize(function(){a=setTimeout(function(){h(b,!0)})}));s.callback.call(b)})}else s.showFunc.call(n(this),n(this).find("."+r.img),s),s.callback.call(b)}function v(t,i){var u=n(t);return u.css("position")=="static"&&u.css("position","relative"),u.find("."+r.wrap).length&&u.find("."+r.wrap).remove(),n('<div class="'+r.wrap+'" style="'+e.wrap+'"><img class="'+r.imgClone+'" style="'+e.imgClone+'" src="'+i+'" /><img class="'+r.img+'" style="'+e.img+'" src="'+i+'" /><\/div>').prependTo(u)}function y(n,t){var i=new Image;i.onload=function(){i.onload=null;typeof t=="function"&&t(i)};i.onerror=function(){o(1,"图片加载出错")};i.src=n}function p(t){var r=n(t).css("backgroundImage"),i;return(n(t).css("backgroundImage","none"),i=r.match(/\"(.*?)\"/)||r.match(/\((.*?)\)/),!i)?(o(0,"获取图片路径出错，此元素没有背景图片"),!1):i[1]}function h(n,r){var e=n.$img,o=n.options.focusVal,f=t.prototype.getZoomInfo.call(n);n.options.mode==0?i(e,f.width):u(e,f.height);r?e.delay(400).animate({marginTop:f.top,marginLeft:f.left},{duration:600,queue:!1,easing:"easeOutExpo"}):e.css({marginTop:f.top,marginLeft:f.left})}function f(i,r,u){var f=i.data("livebg");if(typeof u=="boolean"&&!u){try{delete f[r.autoId];i.data("livebg",f)}catch(o){}return}if(!f){i.bind("mousemove",e);function e(i){var r=this;clearTimeout(s);s=setTimeout(function(){var u=n(r).data("livebg");for(var e in u){var f=t.prototype.getZoomInfo.call(u[e]),o=c(r),s=l(r),h=i.pageX,a=i.pageY,p=h-o<0?0:h-o,w=a-s<0?0:a-s,v=(f.contentWidth-f.width)*p/f.contentWidth,y=(f.contentHeight-f.height)*w/f.contentHeight;switch(u[e].options.followArrow){case 0:u[e].$img.delay(400).animate({marginLeft:v+"px"},{duration:600,queue:!1,easing:"easeOutExpo"});break;case 1:u[e].$img.delay(400).animate({marginTop:y+"px"},{duration:600,queue:!1,easing:"easeOutExpo"});break;case 2:u[e].$img.delay(400).animate({marginTop:y+"px",marginLeft:v+"px"},{duration:600,queue:!1,easing:"easeOutExpo"})}}},0)}f={}}f[r.autoId]=r;i.data("livebg",f)}function i(n,t){return n.css("height","auto").width(t).height()}function u(n,t){return n.css("width","auto").height(t).width()}function c(n){for(var i=n.offsetLeft,t=n.offsetParent;t!==null;)i+=t.offsetLeft,t=t.offsetParent;return i}function l(n){for(var i=n.offsetTop,t=n.offsetParent;t!==null;)i+=t.offsetTop,t=t.offsetParent;return i}var n=n;n.extend(n.easing,{easeOutExpo:function(n,t,i,r,u){return t==u?i+r:r*(-Math.pow(2,-10*t/u)+1)+i}});var e={wrap:"position:fixed;width:100%;height:100%;left:0;top:0;overflow:hidden;_position:absolute;",img:"position:absolute;display:none;",imgClone:"position:absolute;visibility:hidden;"},r={wrap:"livebg",img:"livebg-img",imgClone:"livebg-img-clone"},s=null,o,a=null;return t.autoId=0,t.prototype.getZoomInfo=function(n){var a=this.$wrap,e=this.options,f,o,v;if(!e){alert("元素缺少配置信息");return}n?(f=n.wrapSize?n.wrapSize:{width:a.width(),height:a.height()},o=n.miniSize?n.miniSize:this.minSize):(f={width:a.width(),height:a.height()},o=this.minSize);var s=this.$imgClone,r,t,y=e.focusVal,l=0;this.paddingH===undefined&&(v=e.padding.toString().match("%")?parseInt(f.width*parseInt(e.padding,10)*.01,10):parseInt(e.padding,10),e.mode?(this.paddingV=v,this.paddingH=0):(this.paddingH=v,this.paddingV=0));var l=this.paddingH,h=this.paddingV,c={};return n&&n.imgSize?e.mode==0&&n.imgSize.width?(t=parseInt(n.imgSize.width,10),r=i($img,t)):n.imgSize.height?(r=parseInt(n.imgSize.height,10),t=u($img,r)):(t=parseInt(n.imgSize.width,10),r=i($img,t)):e.mode==0?f.width>=o.width+l*2?(t=f.width+l*2,r=i(s,t),f.height>r&&e.isFull&&(r=f.height,t=u(s,r))):f.height<=o.height?(r=o.height,t=u(s,r)):e.isFull?(r=f.height,t=u(s,r)):(t=o.width+l*2,r=i(s,t)):e.mode==1&&(f.height>=o.height+h*2?(r=f.height+h*2,t=u(s,r),f.width>t&&e.isFull&&(t=f.width+h*2,r=i(s,t))):f.width<=o.width?(t=o.width+h*2,r=i(s,t)):e.isFull?(t=f.width,r=i(s,t)):(r=o.height+h*2,t=u(s,r))),c.width=t,c.height=r,c.top=(f.height-r+h*2)*y.v-h,c.left=(f.width-t+l*2)*y.h-l,c.contentWidth=f.width,c.contentHeight=f.height,c},t.prototype.turnOnFollow=function(n){this.options.follow=n!==undefined?n:this.options.follow?this.options.follow:!0;typeof this.options.follow=="boolean"?f(this.$wrap,this):f(this.options.follow,this)},t.prototype.turnOffFollow=function(){typeof this.options.follow=="boolean"?f(this.$wrap,this,!1):f(this.options.follow,this,!1)},t.prototype.getMousePosition=function(n){var t=c(this.$wrap[0]),i=l(this.$wrap[0]),r=n.pageX,u=n.pageY;return{x:r-t,y:u-i}},t.prototype.reset=function(i){this.$wrap.attr("livebg-init","false");this.$wrap.find("."+r.wrap).remove();t.call(this,this.$wrap,n.extend({},this.options,i))},t.defaults={mode:0,minWidth:600,minHeight:"",isFull:!0,isFixed:!0,focus:"center center",padding:0,src:"",follow:!1,followArrow:2,resizeByWindow:!0,showFunc:function(n){n.fadeIn()},callback:function(){},throwError:function(n,t){n==0?console.error(t):n==1&&alert(t)}},window.Livebg=t});
//# sourceMappingURL=livebg.min.js.map